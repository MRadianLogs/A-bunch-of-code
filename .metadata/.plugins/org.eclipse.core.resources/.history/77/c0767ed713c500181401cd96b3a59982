package yeet;

import java.io.*;
import java.net.*;
import java.util.Scanner;
public class ClientHead {
	
	
	static String input;
	static Socket Sock;
	static InputStreamReader IR;
	static BufferedReader BR;
	static PrintStream PS;
	static int objects = 0;
	static object[] yeet;
	
	static class incomingMessage extends Thread{
		
		
		public void run() {
			String message;
			while(!input.equals("/exit")) {
				try {
					
					message = BR.readLine();
					
					//String test = "object,50,24,900,platform";
					
					int[] values = new int[30];
					int place = 1;
					values[0] = 0;
					
					if(message.contains(",")) {
						for(int i = 0; i < message.length(); i++) {
							if(message.substring(i, i + 1).equals(",")) {
								values[place] = i;
								place++;
								values[place] = i + 1;
								place++;
							}
						}
					
						values[place] = message.length();
						place++;
							if(message.substring(values[0], values[1]).equals("object")) {
								yeet[objects] = new object(Integer.parseInt(message.substring(values[2] , values[3])),Integer.parseInt(message.substring(values[4] , values[5])),Integer.parseInt(message.substring(values[6] , values[7])),message.substring(values[8], values[9]));
								objects++;
							}
						}else{
						System.out.println(message);
					}				
					
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
		
	}
	
	
	public static void main(String[] args) throws UnknownHostException, IOException, InterruptedException {
		yeet = new object[100];
		
		Sock = new Socket("localhost", 6000);
		IR = new InputStreamReader(Sock.getInputStream());
		BR = new BufferedReader(IR);
		PS = new PrintStream(Sock.getOutputStream());
		System.out.println("Player ID: " + BR.readLine());
		input = "";
		
		incomingMessage IM = new incomingMessage();
		
		IM.start();
		
		Scanner kb = new Scanner(System.in);
		
		while(!input.equals("/exit")) {
			input = kb.nextLine();
			if(!input.substring(0, 1).equals("/")) {
				PS.println(input);
			}else{
				if(input.equals("/objects")) {
					for(int i = 0; i < objects; i++) {
						System.out.println("Name: " + yeet[i].getName() + "\nId: " + yeet[i].getId() + "\n(" + yeet[i].getX() + "," + yeet[i].getY() + ")\n");
					}
				}else if(input.equals("/testObjects")){
					
					for(int i = 0; i < 50; i++) {
						PS.println("object," + Math.round(Math.random() * 100) + "," + Math.round(Math.random() * 100) + "," + Math.round(Math.random() * 10000) + "," + "object" + i);
					}
					
					
				}
			}
		}
		
		
		
		kb.close();
		Sock.close();
	
	
	}
}
